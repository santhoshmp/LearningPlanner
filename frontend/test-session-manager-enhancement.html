<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Enhanced Session Manager Test</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n            background-color: #f5f5f5;\n        }\n        .test-container {\n            background: white;\n            padding: 20px;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n            margin-bottom: 20px;\n        }\n        .test-result {\n            padding: 10px;\n            margin: 10px 0;\n            border-radius: 4px;\n            font-weight: bold;\n        }\n        .success {\n            background-color: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n        }\n        .error {\n            background-color: #f8d7da;\n            color: #721c24;\n            border: 1px solid #f5c6cb;\n        }\n        .info {\n            background-color: #d1ecf1;\n            color: #0c5460;\n            border: 1px solid #bee5eb;\n        }\n        .warning {\n            background-color: #fff3cd;\n            color: #856404;\n            border: 1px solid #ffeaa7;\n        }\n        button {\n            background-color: #007bff;\n            color: white;\n            border: none;\n            padding: 10px 20px;\n            border-radius: 4px;\n            cursor: pointer;\n            margin: 5px;\n        }\n        button:hover {\n            background-color: #0056b3;\n        }\n        .log {\n            background-color: #f8f9fa;\n            border: 1px solid #dee2e6;\n            padding: 10px;\n            border-radius: 4px;\n            font-family: monospace;\n            font-size: 12px;\n            max-height: 300px;\n            overflow-y: auto;\n            white-space: pre-wrap;\n        }\n    </style>\n</head>"<
body>\n    <h1>üîß Enhanced Session Manager Test</h1>\n    <p>Comprehensive testing for the enhanced session management utility.</p>\n\n    <div class=\"test-container\">\n        <h2>üß™ Session Manager Tests</h2>\n        <button onclick=\"testSessionSave()\">Test Session Save</button>\n        <button onclick=\"testSessionLoad()\">Test Session Load</button>\n        <button onclick=\"testSessionValidation()\">Test Validation</button>\n        <button onclick=\"testCorruptionDetection()\">Test Corruption Detection</button>\n        <button onclick=\"testSessionExpiry()\">Test Session Expiry</button>\n        <button onclick=\"testBackupRestore()\">Test Backup/Restore</button>\n        <button onclick=\"testMetrics()\">Test Metrics</button>\n        <button onclick=\"clearSession()\">Clear Session</button>\n        <button onclick=\"runAllTests()\">Run All Tests</button>\n        \n        <div id=\"testResults\"></div>\n    </div>\n\n    <div class=\"test-container\">\n        <h2>üìä Session Debug Info</h2>\n        <button onclick=\"displayDebugInfo()\">Refresh Debug Info</button>\n        <div id=\"debugInfo\"></div>\n    </div>\n\n    <div class=\"test-container\">\n        <h2>üìù Test Log</h2>\n        <button onclick=\"clearLog()\">Clear Log</button>\n        <div id=\"testLog\" class=\"log\"></div>\n    </div>\n\n    <script>\n        // Mock Enhanced Session Manager for testing\n        class MockEnhancedSessionManager {\n            static STORAGE_KEYS = {\n                ACCESS_TOKEN: 'accessToken',\n                REFRESH_TOKEN: 'refreshToken',\n                USER: 'user',\n                USER_ROLE: 'userRole',\n                LOGIN_TIME: 'loginTime',\n                SESSION_ID: 'sessionId',\n                LAST_ACTIVITY: 'lastActivity',\n                DEVICE_INFO: 'deviceInfo',\n                SESSION_VERSION: 'sessionVersion',\n                ACTIVITY_COUNT: 'activityCount'\n            };\n\n            static SESSION_VERSION = '1.0.0';\n            static MAX_SESSION_AGE = 24 * 60 * 60 * 1000;\n            static CHILD_SESSION_AGE = 2 * 60 * 60 * 1000;\n            static ACTIVITY_TIMEOUT = 30 * 60 * 1000;\n\n            static saveSession(sessionData, createBackup = true) {\n                try {\n                    const enhancedSessionData = {\n                        ...sessionData,\n                        lastActivity: new Date().toISOString(),\n                        version: this.SESSION_VERSION,\n                        deviceInfo: sessionData.deviceInfo || this.captureDeviceInfo()\n                    };\n\n                    const validation = this.validateSessionData(enhancedSessionData);\n                    if (!validation.isValid) {\n                        throw new Error(`Invalid session data: ${validation.errors.join(', ')}`);\n                    }\n\n                    localStorage.setItem(this.STORAGE_KEYS.ACCESS_TOKEN, enhancedSessionData.accessToken);\n                    localStorage.setItem(this.STORAGE_KEYS.REFRESH_TOKEN, enhancedSessionData.refreshToken);\n                    localStorage.setItem(this.STORAGE_KEYS.USER, JSON.stringify(enhancedSessionData.user));\n                    localStorage.setItem(this.STORAGE_KEYS.USER_ROLE, enhancedSessionData.userRole);\n                    localStorage.setItem(this.STORAGE_KEYS.LOGIN_TIME, enhancedSessionData.loginTime);\n                    localStorage.setItem(this.STORAGE_KEYS.LAST_ACTIVITY, enhancedSessionData.lastActivity);\n                    localStorage.setItem(this.STORAGE_KEYS.SESSION_VERSION, this.SESSION_VERSION);\n                    localStorage.setItem(this.STORAGE_KEYS.ACTIVITY_COUNT, '1');\n                    \n                    if (enhancedSessionData.sessionId) {\n                        localStorage.setItem(this.STORAGE_KEYS.SESSION_ID, enhancedSessionData.sessionId);\n                    }\n                    \n                    if (enhancedSessionData.deviceInfo) {\n                        localStorage.setItem(this.STORAGE_KEYS.DEVICE_INFO, JSON.stringify(enhancedSessionData.deviceInfo));\n                    }\n                    \n                    return true;\n                } catch (error) {\n                    throw error;\n                }\n            }\n\n            static loadSession() {\n                try {\n                    const accessToken = localStorage.getItem(this.STORAGE_KEYS.ACCESS_TOKEN);\n                    const refreshToken = localStorage.getItem(this.STORAGE_KEYS.REFRESH_TOKEN);\n                    const userStr = localStorage.getItem(this.STORAGE_KEYS.USER);\n                    const userRole = localStorage.getItem(this.STORAGE_KEYS.USER_ROLE);\n                    const loginTime = localStorage.getItem(this.STORAGE_KEYS.LOGIN_TIME);\n                    const lastActivity = localStorage.getItem(this.STORAGE_KEYS.LAST_ACTIVITY);\n                    const sessionId = localStorage.getItem(this.STORAGE_KEYS.SESSION_ID);\n                    const deviceInfoStr = localStorage.getItem(this.STORAGE_KEYS.DEVICE_INFO);\n                    const sessionVersion = localStorage.getItem(this.STORAGE_KEYS.SESSION_VERSION);\n\n                    if (!accessToken || !refreshToken || !userStr || !userRole) {\n                        return null;\n                    }\n\n                    let user, deviceInfo;\n                    try {\n                        user = JSON.parse(userStr);\n                        if (deviceInfoStr) deviceInfo = JSON.parse(deviceInfoStr);\n                    } catch (error) {\n                        return null;\n                    }\n\n                    const sessionData = {\n                        user,\n                        userRole,\n                        accessToken,\n                        refreshToken,\n                        loginTime: loginTime || new Date().toISOString(),\n                        lastActivity: lastActivity || new Date().toISOString(),\n                        sessionId: sessionId || undefined,\n                        deviceInfo,\n                        version: sessionVersion || '1.0.0'\n                    };\n\n                    const validation = this.validateSessionData(sessionData);\n                    if (!validation.isValid) {\n                        return null;\n                    }\n\n                    return sessionData;\n                } catch (error) {\n                    return null;\n                }\n            }\n\n            static validateSessionData(sessionData) {\n                const errors = [];\n                const warnings = [];\n\n                if (!sessionData.user || !sessionData.user.id) {\n                    errors.push('Missing or invalid user data');\n                }\n                \n                if (!sessionData.userRole || !['parent', 'child'].includes(sessionData.userRole)) {\n                    errors.push('Missing or invalid user role');\n                }\n                \n                if (!sessionData.accessToken || typeof sessionData.accessToken !== 'string') {\n                    errors.push('Missing or invalid access token');\n                }\n                \n                if (!sessionData.refreshToken || typeof sessionData.refreshToken !== 'string') {\n                    errors.push('Missing or invalid refresh token');\n                }\n\n                if (sessionData.user && sessionData.userRole) {\n                    const expectedRole = sessionData.user.role === 'CHILD' ? 'child' : 'parent';\n                    if (sessionData.userRole !== expectedRole) {\n                        errors.push(`Role mismatch: userRole=${sessionData.userRole}, user.role=${sessionData.user.role}`);\n                    }\n                }\n\n                if (sessionData.userRole === 'child') {\n                    if (!sessionData.user.username || !sessionData.user.name) {\n                        errors.push('Missing required child fields');\n                    }\n                }\n\n                if (sessionData.userRole === 'parent') {\n                    if (!sessionData.user.email || !sessionData.user.firstName) {\n                        errors.push('Missing required parent fields');\n                    }\n                }\n\n                return {\n                    isValid: errors.length === 0,\n                    errors,\n                    warnings,\n                    data: errors.length === 0 ? sessionData : undefined\n                };\n            }\n\n            static clearSession() {\n                const keysToRemove = Object.values(this.STORAGE_KEYS);\n                keysToRemove.forEach(key => localStorage.removeItem(key));\n            }\n\n            static hasSession() {\n                return !!(localStorage.getItem(this.STORAGE_KEYS.ACCESS_TOKEN) && \n                          localStorage.getItem(this.STORAGE_KEYS.REFRESH_TOKEN));\n            }\n\n            static getCurrentUserRole() {\n                return localStorage.getItem(this.STORAGE_KEYS.USER_ROLE);\n            }\n\n            static isSessionExpired(sessionData) {\n                try {\n                    const loginTime = sessionData?.loginTime || localStorage.getItem(this.STORAGE_KEYS.LOGIN_TIME);\n                    const userRole = sessionData?.userRole || this.getCurrentUserRole();\n                    \n                    if (!loginTime) return true;\n\n                    const loginDate = new Date(loginTime);\n                    const now = new Date();\n                    \n                    const maxAge = userRole === 'child' ? this.CHILD_SESSION_AGE : this.MAX_SESSION_AGE;\n                    const sessionAge = now.getTime() - loginDate.getTime();\n                    \n                    return sessionAge > maxAge;\n                } catch (error) {\n                    return true;\n                }\n            }\n\n            static getSessionDebugInfo() {\n                const sessionData = this.loadSession();\n                \n                return {\n                    hasSession: this.hasSession(),\n                    userRole: this.getCurrentUserRole(),\n                    userId: sessionData?.user?.id,\n                    userDbRole: sessionData?.user?.role,\n                    hasAccessToken: !!localStorage.getItem(this.STORAGE_KEYS.ACCESS_TOKEN),\n                    hasRefreshToken: !!localStorage.getItem(this.STORAGE_KEYS.REFRESH_TOKEN),\n                    hasSessionId: !!localStorage.getItem(this.STORAGE_KEYS.SESSION_ID),\n                    loginTime: localStorage.getItem(this.STORAGE_KEYS.LOGIN_TIME),\n                    lastActivity: localStorage.getItem(this.STORAGE_KEYS.LAST_ACTIVITY),\n                    sessionVersion: localStorage.getItem(this.STORAGE_KEYS.SESSION_VERSION),\n                    isExpired: this.isSessionExpired(),\n                    validation: sessionData ? this.validateSessionData(sessionData) : null\n                };\n            }\n\n            static captureDeviceInfo() {\n                return {\n                    userAgent: navigator.userAgent,\n                    platform: navigator.platform,\n                    isMobile: /Mobile|Android|iPhone|iPad/.test(navigator.userAgent),\n                    screenResolution: `${screen.width}x${screen.height}`,\n                    language: navigator.language,\n                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone\n                };\n            }\n        }\n\n        const SessionManager = MockEnhancedSessionManager;\n        let testLog = [];\n        let testResults = [];\n\n        function log(message, type = 'info') {\n            const timestamp = new Date().toLocaleTimeString();\n            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}`;\n            testLog.push(logEntry);\n            updateLogDisplay();\n            console.log(logEntry);\n        }\n\n        function updateLogDisplay() {\n            const logElement = document.getElementById('testLog');\n            logElement.textContent = testLog.join('\\n');\n            logElement.scrollTop = logElement.scrollHeight;\n        }\n\n        function clearLog() {\n            testLog = [];\n            updateLogDisplay();\n        }\n\n        function showResult(message, isSuccess, type = 'test') {\n            const resultsDiv = document.getElementById('testResults');\n            const resultDiv = document.createElement('div');\n            resultDiv.className = `test-result ${isSuccess ? 'success' : 'error'}`;\n            resultDiv.textContent = message;\n            resultsDiv.appendChild(resultDiv);\n            \n            testResults.push({ message, isSuccess, type, timestamp: new Date().toISOString() });\n        }\n\n        function clearResults() {\n            document.getElementById('testResults').innerHTML = '';\n            testResults = [];\n        }\n\n        // Test functions continue in next part...\n    </script>\n</body>\n</html>"        // 
Test Functions\n        function testSessionSave() {\n            log('=== Testing Session Save ===');\n            \n            try {\n                const childSessionData = {\n                    user: {\n                        id: 'child123',\n                        role: 'CHILD',\n                        username: 'testchild',\n                        name: 'Test Child',\n                        parentId: 'parent123',\n                        age: 10,\n                        grade: '5th'\n                    },\n                    userRole: 'child',\n                    accessToken: 'child_access_token_12345',\n                    refreshToken: 'child_refresh_token_12345',\n                    loginTime: new Date().toISOString(),\n                    sessionId: 'child_session_123'\n                };\n\n                SessionManager.saveSession(childSessionData);\n                \n                const loaded = SessionManager.loadSession();\n                if (loaded && loaded.user.id === 'child123') {\n                    showResult('‚úÖ Child session save/load successful', true);\n                } else {\n                    showResult('‚ùå Child session save/load failed', false);\n                }\n\n                // Test parent session\n                const parentSessionData = {\n                    user: {\n                        id: 'parent123',\n                        role: 'PARENT',\n                        email: 'parent@test.com',\n                        firstName: 'Test',\n                        lastName: 'Parent',\n                        isEmailVerified: true\n                    },\n                    userRole: 'parent',\n                    accessToken: 'parent_access_token_12345',\n                    refreshToken: 'parent_refresh_token_12345',\n                    loginTime: new Date().toISOString()\n                };\n\n                SessionManager.saveSession(parentSessionData);\n                \n                const loadedParent = SessionManager.loadSession();\n                if (loadedParent && loadedParent.user.id === 'parent123') {\n                    showResult('‚úÖ Parent session save/load successful', true);\n                } else {\n                    showResult('‚ùå Parent session save/load failed', false);\n                }\n            } catch (error) {\n                showResult(`‚ùå Session save test failed: ${error.message}`, false);\n            }\n        }\n\n        function testSessionLoad() {\n            log('=== Testing Session Load ===');\n            \n            try {\n                // Test loading non-existent session\n                SessionManager.clearSession();\n                const emptySession = SessionManager.loadSession();\n                \n                if (emptySession === null) {\n                    showResult('‚úÖ Empty session load handled correctly', true);\n                } else {\n                    showResult('‚ùå Empty session load should return null', false);\n                }\n\n                // Test loading valid session\n                const validSession = {\n                    user: {\n                        id: 'test123',\n                        role: 'CHILD',\n                        username: 'testuser',\n                        name: 'Test User'\n                    },\n                    userRole: 'child',\n                    accessToken: 'valid_token',\n                    refreshToken: 'valid_refresh',\n                    loginTime: new Date().toISOString()\n                };\n\n                SessionManager.saveSession(validSession);\n                const loaded = SessionManager.loadSession();\n                \n                if (loaded && loaded.user.id === 'test123') {\n                    showResult('‚úÖ Valid session load successful', true);\n                } else {\n                    showResult('‚ùå Valid session load failed', false);\n                }\n            } catch (error) {\n                showResult(`‚ùå Session load test failed: ${error.message}`, false);\n            }\n        }\n\n        function testSessionValidation() {\n            log('=== Testing Session Validation ===');\n            \n            try {\n                // Test valid session data\n                const validSession = {\n                    user: {\n                        id: 'test123',\n                        role: 'CHILD',\n                        username: 'testuser',\n                        name: 'Test User'\n                    },\n                    userRole: 'child',\n                    accessToken: 'valid_token_12345',\n                    refreshToken: 'valid_refresh_12345',\n                    loginTime: new Date().toISOString()\n                };\n\n                const validation = SessionManager.validateSessionData(validSession);\n                if (validation.isValid) {\n                    showResult('‚úÖ Valid session data validation passed', true);\n                } else {\n                    showResult(`‚ùå Valid session validation failed: ${validation.errors.join(', ')}`, false);\n                }\n\n                // Test invalid session data\n                const invalidSession = {\n                    user: { id: 'test123', role: 'CHILD' }, // Missing required child fields\n                    userRole: 'child',\n                    accessToken: '', // Empty token\n                    refreshToken: 'valid_refresh',\n                    loginTime: new Date().toISOString()\n                };\n\n                const invalidValidation = SessionManager.validateSessionData(invalidSession);\n                if (!invalidValidation.isValid && invalidValidation.errors.length > 0) {\n                    showResult('‚úÖ Invalid session data properly rejected', true);\n                } else {\n                    showResult('‚ùå Invalid session data should be rejected', false);\n                }\n\n                // Test role mismatch\n                const roleMismatch = {\n                    user: { id: 'test123', role: 'PARENT', email: 'test@test.com', firstName: 'Test' },\n                    userRole: 'child', // Mismatch!\n                    accessToken: 'valid_token',\n                    refreshToken: 'valid_refresh',\n                    loginTime: new Date().toISOString()\n                };\n\n                const mismatchValidation = SessionManager.validateSessionData(roleMismatch);\n                if (!mismatchValidation.isValid && mismatchValidation.errors.some(e => e.includes('mismatch'))) {\n                    showResult('‚úÖ Role mismatch properly detected', true);\n                } else {\n                    showResult('‚ùå Role mismatch should be detected', false);\n                }\n            } catch (error) {\n                showResult(`‚ùå Session validation test failed: ${error.message}`, false);\n            }\n        }\n\n        function testCorruptionDetection() {\n            log('=== Testing Corruption Detection ===');\n            \n            try {\n                // Test corrupted JSON\n                localStorage.setItem('user', '{invalid json}');\n                localStorage.setItem('accessToken', 'valid_token');\n                localStorage.setItem('refreshToken', 'valid_refresh');\n                localStorage.setItem('userRole', 'child');\n                \n                const corruptedSession = SessionManager.loadSession();\n                if (corruptedSession === null) {\n                    showResult('‚úÖ Corrupted JSON properly handled', true);\n                } else {\n                    showResult('‚ùå Corrupted JSON should return null', false);\n                }\n\n                // Test missing required fields\n                SessionManager.clearSession();\n                localStorage.setItem('accessToken', 'valid_token');\n                // Missing other required fields\n                \n                const incompleteSession = SessionManager.loadSession();\n                if (incompleteSession === null) {\n                    showResult('‚úÖ Incomplete session data properly handled', true);\n                } else {\n                    showResult('‚ùå Incomplete session should return null', false);\n                }\n            } catch (error) {\n                showResult(`‚ùå Corruption detection test failed: ${error.message}`, false);\n            }\n        }\n\n        function testSessionExpiry() {\n            log('=== Testing Session Expiry ===');\n            \n            try {\n                // Test non-expired session\n                const recentSession = {\n                    user: { id: 'test123', role: 'CHILD', username: 'test', name: 'Test' },\n                    userRole: 'child',\n                    accessToken: 'token',\n                    refreshToken: 'refresh',\n                    loginTime: new Date().toISOString() // Recent login\n                };\n\n                if (!SessionManager.isSessionExpired(recentSession)) {\n                    showResult('‚úÖ Recent session not expired', true);\n                } else {\n                    showResult('‚ùå Recent session should not be expired', false);\n                }\n\n                // Test expired session\n                const oldDate = new Date(Date.now() - 25 * 60 * 60 * 1000); // 25 hours ago\n                const expiredSession = {\n                    user: { id: 'test123', role: 'PARENT', email: 'test@test.com', firstName: 'Test' },\n                    userRole: 'parent',\n                    accessToken: 'token',\n                    refreshToken: 'refresh',\n                    loginTime: oldDate.toISOString()\n                };\n\n                if (SessionManager.isSessionExpired(expiredSession)) {\n                    showResult('‚úÖ Old session properly expired', true);\n                } else {\n                    showResult('‚ùå Old session should be expired', false);\n                }\n\n                // Test child session expiry (shorter timeout)\n                const oldChildDate = new Date(Date.now() - 3 * 60 * 60 * 1000); // 3 hours ago\n                const expiredChildSession = {\n                    user: { id: 'test123', role: 'CHILD', username: 'test', name: 'Test' },\n                    userRole: 'child',\n                    accessToken: 'token',\n                    refreshToken: 'refresh',\n                    loginTime: oldChildDate.toISOString()\n                };\n\n                if (SessionManager.isSessionExpired(expiredChildSession)) {\n                    showResult('‚úÖ Old child session properly expired', true);\n                } else {\n                    showResult('‚ùå Old child session should be expired', false);\n                }\n            } catch (error) {\n                showResult(`‚ùå Session expiry test failed: ${error.message}`, false);\n            }\n        }\n\n        function testBackupRestore() {\n            log('=== Testing Backup/Restore ===');\n            \n            try {\n                // This is a simplified test since backup/restore is more complex\n                const testSession = {\n                    user: { id: 'backup123', role: 'CHILD', username: 'backup', name: 'Backup Test' },\n                    userRole: 'child',\n                    accessToken: 'backup_token',\n                    refreshToken: 'backup_refresh',\n                    loginTime: new Date().toISOString()\n                };\n\n                SessionManager.saveSession(testSession);\n                const loaded = SessionManager.loadSession();\n                \n                if (loaded && loaded.user.id === 'backup123') {\n                    showResult('‚úÖ Backup/restore simulation successful', true);\n                } else {\n                    showResult('‚ùå Backup/restore simulation failed', false);\n                }\n            } catch (error) {\n                showResult(`‚ùå Backup/restore test failed: ${error.message}`, false);\n            }\n        }\n\n        function testMetrics() {\n            log('=== Testing Session Metrics ===');\n            \n            try {\n                const testSession = {\n                    user: { id: 'metrics123', role: 'PARENT', email: 'metrics@test.com', firstName: 'Metrics' },\n                    userRole: 'parent',\n                    accessToken: 'metrics_token',\n                    refreshToken: 'metrics_refresh',\n                    loginTime: new Date().toISOString()\n                };\n\n                SessionManager.saveSession(testSession);\n                \n                // Test debug info\n                const debugInfo = SessionManager.getSessionDebugInfo();\n                \n                if (debugInfo.hasSession && debugInfo.userId === 'metrics123') {\n                    showResult('‚úÖ Session metrics and debug info working', true);\n                } else {\n                    showResult('‚ùå Session metrics failed', false);\n                }\n            } catch (error) {\n                showResult(`‚ùå Metrics test failed: ${error.message}`, false);\n            }\n        }\n\n        function clearSession() {\n            SessionManager.clearSession();\n            showResult('‚úÖ Session cleared', true);\n            displayDebugInfo();\n        }\n\n        function displayDebugInfo() {\n            const debugInfo = SessionManager.getSessionDebugInfo();\n            const debugInfoDiv = document.getElementById('debugInfo');\n            \n            debugInfoDiv.innerHTML = `\n                <div class=\"info\">\n                    <h4>Session Debug Information</h4>\n                    <pre>${JSON.stringify(debugInfo, null, 2)}</pre>\n                </div>\n            `;\n        }\n\n        async function runAllTests() {\n            log('=== Running All Session Manager Tests ===');\n            clearResults();\n            \n            try {\n                testSessionSave();\n                await new Promise(resolve => setTimeout(resolve, 500));\n                \n                testSessionLoad();\n                await new Promise(resolve => setTimeout(resolve, 500));\n                \n                testSessionValidation();\n                await new Promise(resolve => setTimeout(resolve, 500));\n                \n                testCorruptionDetection();\n                await new Promise(resolve => setTimeout(resolve, 500));\n                \n                testSessionExpiry();\n                await new Promise(resolve => setTimeout(resolve, 500));\n                \n                testBackupRestore();\n                await new Promise(resolve => setTimeout(resolve, 500));\n                \n                testMetrics();\n                \n                log('=== All Tests Completed ===');\n                \n                const totalTests = testResults.length;\n                const passedTests = testResults.filter(r => r.isSuccess).length;\n                \n                showResult(`üéâ Test Suite Complete: ${passedTests}/${totalTests} tests passed`, passedTests === totalTests);\n            } catch (error) {\n                log(`Test suite failed: ${error.message}`, 'error');\n                showResult(`‚ùå Test suite failed: ${error.message}`, false);\n            }\n        }\n\n        // Initialize\n        log('Enhanced Session Manager Test Page Loaded');\n        displayDebugInfo();\n    </script>\n</body>\n</html>"